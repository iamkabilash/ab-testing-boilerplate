/*!/////////////////////////////////////////////////////////////
 *  wto-client
    Handy wrapper for accessing information of Optimize runtime
    @author Romas Kriauciukas, Webtrends, 2016
    @version 0.2.1
    @built  2016-02-01 15:59
 ////////////////////////////////////////////////////////////////
*/
var WTOClient=function(){if(this instanceof WTOClient===false){return new WTOClient()}var a=this;var b={Library:"z32ad",g_RunObjList:"z2b20",params:"zccdd",params_v30:"zccdd3ca1db",g_ParamsList:"zf310",g_ConfigParams:"z23eb",_decrypt:"zcc1d",_encrypt:"zcdd3",decryptTea:"z7f69",encryptTea:"z71df",g_PageEndTime:"z93cb",g_PageTimer:"z907d",g_Aborted:"ze3c2"};function c(d){return b[d]}a.getRuntime=function(){if(a.isRunningOnJAPI()){return WTOptimize}return(window.WT&&window.WT.optimize)||window.WTOptimize||window.WTO_JAPI||null};a.getLibObj=function(){var d=this.getRuntime();return d&&(d[c("Library")]||d.Library)};a.getReqArr=function(){var d=this.getRuntime();return d&&d[c("g_RunObjList")]||d&&d.g_RunObjList||[]};a.getReqParamObjects=function(){var e=this.getReqArr();var f=[];if(e instanceof Array){for(var d=0,h=e.length;d<h;d++){var g=e[d];f.push(g.params||g[c("params")]||g[c("params_v30")])}}return f};a.lookup=function(g){if(this.isJAPI()){var f=window.WTO_JAPI.projects[g];if(f){f.getParams=f.getParams||function(){return f.Config}}return f}var d=this.getRuntime();var e=d.lookup||d.runMgr&&d.runMgr.lookup;return e&&e.apply(d,[g])};a.paramCache={};a.getParam=function(j,g){var l=this.paramCache[j];if(g&&typeof l!=="undefined"){return l}var d=this.getRuntime()||{};var h=this.getParamsDefault()||{};var f=this.getReqParamObjects();f=f&&f[0]||{};var e=d[c("g_ParamsList")]&&d[c("g_ParamsList")][0]||{};var i=this.getParamsLibV4()||{};var k;if(typeof f[j]!=="undefined"){k=f[j]}else{if(typeof h[j]!=="undefined"){k=h[j]}else{if(typeof e[j]!=="undefined"){k=e[j]}}}if(j==="s_otsServer"&&k==="ots.webtrends.com"){k="ots.optimize.webtrends.com"}if(k==="0000"){k=e[j]||i[j]}if(typeof k!=="undefined"){this.paramCache[j]=k}return k};a.getParamsDefault=function(){var d=this.getRuntime()||{};return d[c("g_ConfigParams")]||d.g_ConfigParams};a.getParamsLibV4=function(){try{return window.WT&&window.WT.optimizeModule&&window.WT.optimizeModule.prototype.wtConfigObj||{}}catch(d){}return{}};a.getParams=function(){if(this.isRunningOnJAPI()){return JAPI.Config}return this.getParamsDefault()||{}};a.getRunParam=function(d,f){var e=this.getRunParams(f);return e&&e[d]};a.getRunParams=function(e){var d=this.lookup(e);if(d){return d.getParams()}return{}};a.useTEA=function(){return Boolean(this.getVersion().match(/^3\.[0-1]$/i)===null)};a.getDecodeFunc31=function(){var d=this.getLibObj();return d&&(d[c("_decrypt")]||d._decrypt)};a.getDecodeFuncTEA=function(){var d=this.getLibObj();return d&&(d[c("decryptTea")]||d.decryptTea)};a.getEncodeFunc31=function(){var d=this.getLibObj();return d&&(d[c("_encrypt")]||d._encrypt)};a.getEncodeFuncTEA=function(){var d=this.getLibObj();return d&&(d[c("encryptTea")]||d.encryptTea)};a.decode=function(g,f){var e=Boolean(g.search(/^WT3/i)>-1);var d=e?this.getDecodeFuncTEA():this.getDecodeFunc31();return d&&d.apply(this.getLibObj(),[g,f||this.getParam("s_keyToken",true)])};a.decodeTEA=function(f,d){var e=this.getDecodeFuncTEA();if(!e){throw"CL.decodeTEA: decoder function not found"}return e.apply(this.getLibObj(),[f,d||this.getParam("s_keyToken",true)])};a.encode=function(f,d){var e=a.useTEA()?this.getEncodeFuncTEA():this.getEncodeFunc31();return this.encodeWithFunc(e,f,d)};a.encodeWithFunc=function(f,g,e){var d=this.getLibObj();return f&&f.apply(d,[g,e||this.getParam("s_keyToken",true)])};a.encodeTEA=function(f,d){var e=this.getEncodeFuncTEA();return this.encodeWithFunc(e,f,d)};a.hasCookieCryptoMismatch=function(){var d=a.getVersionInfo();if(d.full.search(/3\.[01]\./i)===-1){return false}var e=a.getCookies();for(var g in e){if(!e.hasOwnProperty(g)){continue}var f=e[g];if(f.search(/^WT3/i)>-1){return true}}return false};a.getVersionInfo=function(){var e={full:"",major:"",minor:"",inc:""};var d=this.getParam("s_capiMajorVersion",true);var g=this.getParam("s_capiMinorVersion",true);var f=this.getParam("s_capiIncVersion",true);e.full=d?[d,g,f].join("."):"";e.major=d;e.minor=g;e.inc=f;return e};a.getVersion=function(){var e=this.getVersionInfo();var d=e.major;var f=e.minor;return(d?d+"."+f:"")};a.getVersionFull=function(){var d=this.getVersionInfo();return d.full};a.getIntegrationFacts=function(){};a.hasTimedOut=function(){var e=this.getRuntime();if(!e){return false}var d=e.g_PageEndTime||e[c("g_PageEndTime")];var f=e.g_PageTimer||e[c("g_PageTimer")];return Boolean(d&&!f)};a.hasAborted=function(){var e=this.getRuntime();if(!e){return false}var d=e.g_Aborted||e[c("g_Aborted")];return d};a.getConversionFunc=function(){var d=this.getRuntime();return(d&&(d.click||d.conversion))||function(){}};a.conversion=function(h){var f=this.getConversionFunc();var d=this.getRuntime();var e=f.length;var g=[h.testAlias,h];if(e===1||window.WT&&window.WT.optimize){g=[h]}f.apply(d,g)};a.setRunData=function(e,g){var d=this.getRunParam("data",e);if(d){for(var f in g){if(!g.hasOwnProperty(f)){continue}d[f]=g[f]}}return d};a.getAddEventFunc=function(){var d=this.getRuntime();return(window.WT&&window.WT.addEventHandler)||(d&&d.addEventHandler)};a.addEventHandler=function(f,e,h){var d=this.getRuntime();if(!d){return}var g=this.getAddEventFunc();g.apply(d||window.WT,[f,e,h])};a.hasEventHandler=function(j,k,e){var h=this.getParam("s_eventHandlers");var f=h&&h[j]&&h[j]["success"];if(f){for(var g=0,d=f.length;g<d;g++){var m=f[g];if(String(m)===String(e)){return true}}}return false};a.getMode=function(){var d=this.decodeCookies();var e=d["_wt.mode-"+this.getParam("s_domainKey")];return e&&e.value||this.getParam("s_mode")};a.inDebugMode=function(){return Boolean()};a.isActive=function(){var d=this.getRuntime();return Boolean(d&&d.conversion)};a.getCookies=function(){var j={};var h=document.cookie.match(/_wt\.(control|user|mode|conversion|activeSplit)-[^=]+=[^;\s$]+/ig);if(h){for(var g=0,d=h.length;g<d;g++){var f=h[g].split("=");var e=f[0];var k=f[1];j[e]=k}}return j};a.decodeCookies=function(){var g={};try{var f=this.getCookies();for(var j in f){if(!f.hasOwnProperty(j)){continue}var i=f[j];var h=this.decode(i);if(h){var d=h&&h.match(/^(?!.*\uFFFD)\{/i)?JSON.parse(h):{};g[j]={value:h,valueObj:d}}}}catch(e){console.error(e)}return g};a.isUsing3rdPartyCookies=function(){var f=this.getReqParamObjects();for(var e=0,d=f.length;e<d;e++){var g=f[e];if(g.use3rdPartyCookies){return true}}return false};a.isCTag=function(){return Boolean(window.WT&&typeof window.WT.optimize!=="undefined")};a.getContextForced=function(f){var d=f||window.location.href;var i=/_wt\.context=([^#$&;]+)/i;var h=d.match(i);var g=document.cookie.match(i);var e=h&&h[1];if(e){e=decodeURIComponent(e)}return(e||g&&g[1]||"")};a.getContextActive=function(){var e=window.WT&&window.WT.getProduct&&window.WT.getProduct("optimize");var d=e&&e.contextName;return d?"optimize:"+d:"default"};a.contextIsForced=function(){return this.getContextForced()!==""};a.setContextCookie=function(d){document.cookie="_wt.context="+d+";path=/"};a.contextDelCookie=function(){document.cookie="_wt.context=;path=/;expires="+(new Date(0)).toUTCString()};a.isRunningOnJAPI=function(){return Boolean(typeof JAPI==="object"&&WTOptimize&&WTOptimize.pausePageview)};a.isJAPI=function(){return Boolean(typeof JAPI==="object"&&WTOptimize&&WTOptimize.pausePageview)};a.hasJAPI=function(){return typeof window.WTO_JAPI!=="undefined"};a.getJAPIVer=function(){if(this.hasJAPI()){return window.WTO_JAPI.Config.ver}return""};return a};